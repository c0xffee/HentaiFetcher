# Active Context

## Current Focus (ç›®å‰ç„¦é»)
- âœ… Discord UI å…ƒä»¶æ•´åˆå®Œæˆ v3.3.0 - Phase 3 å®Œæˆ

## Recent Changes (æœ€è¿‘æ›´å‹•)
- [x] 2026-01-02 å¯¦ä½œ PaginatedListView (Step 3.6)
  - `/list` æ”¹ç‚ºåˆ†é  Embed é¡¯ç¤º
  - æ¯é  15 ç­†ï¼Œæ”¯æ´ä¸Š/ä¸‹é ã€é¦–é /æœ«é æŒ‰éˆ•
  - çµ±è¨ˆè³‡è¨Šæ•´åˆåˆ° Embed ä¸­
- [x] 2026-01-02 å¯¦ä½œ Discord UI Views (Phase 3.1-3.5)
  - å»ºç«‹ `bot/views/` æ¨¡çµ„çµæ§‹
  - `base.py` - æŒä¹…åŒ– View åŸºç¤é¡åˆ¥ (5åˆ†é˜è¶…æ™‚)
  - `search_view.py` - SearchResultView (Select Menu â†’ /read)
  - `read_view.py` - ReadDetailView (Tag Select + æ“ä½œæŒ‰éˆ•)
  - `random_view.py` - RandomResultView (å†æŠ½ä¸€æ¬¡ç­‰æŒ‰éˆ•)
  - `download_view.py` - DownloadCompleteView (ä¸‹è¼‰å®ŒæˆæŒ‰éˆ•)
  - `list_view.py` - PaginatedListView (åˆ†é åˆ—è¡¨)
  - `eagle_library.py` æ–°å¢ `find_by_tag()` æ–¹æ³•
  - ç‰ˆæœ¬å‡ç´š 3.2.0 â†’ 3.3.0
- [x] 2026-01-02 è¦åŠƒ Discord UI å…ƒä»¶æ•´åˆæ–¹æ¡ˆ
- [x] 2026-01-02 ä¿®å¾©è©•è«–è§£æ + é¡¯ç¤ºå…¨éƒ¨ metadata
  - `parse_annotation_comments()` æ­£ç¢ºè§£æç”¨æˆ¶åå’Œè©•è«–å…§å®¹
  - é¡¯ç¤ºæ ¼å¼ï¼š`**[ç”¨æˆ¶å] (æ™‚é–“)**` + è©•è«–å…§å®¹
  - ç§»é™¤æ‰€æœ‰æ•¸é‡é™åˆ¶ï¼šå…¨éƒ¨æ¨™ç±¤ã€è§’è‰²ã€è©•è«–
- [x] 2026-01-02 `/search` å’Œ `/read` æ”¯æ´é›™ä¾†æº
  - åˆä½µ Eagle Library + downloads è³‡æ–™å¤¾æœå°‹
  - `/search` æ–°å¢ `source` åƒæ•¸ (all/eagle/downloads)
  - `/read` è‡ªå‹•æŸ¥è©¢é›™ä¾†æº
  - æ”¹é€²æœå°‹ï¼šæ”¯æ´æ—¥æ–‡/ä¸­æ–‡/æ¨™é»ç¬¦è™Ÿ (unicodedata.normalize)
  - ç²¾ç°¡æ¨¡å¼ï¼š>5 çµæœç”¨ embedï¼Œâ‰¤5 çµæœé¡¯ç¤ºå°é¢
- [x] 2026-01-02 `/random` ä¿®æ­£ Markdown é€£çµæ ¼å¼
  - ä¿®æ­£ï¼š`[ğŸ“– **title**](url)` â†’ `ğŸ“– [title](url)`
  - emoji ç§»åˆ°é€£çµå¤–éƒ¨ä»¥ç¢ºä¿æ ¼å¼æ­£ç¢º
- [x] 2026-01-02 `/random` downloads ä¾†æºä½¿ç”¨ PDF é€£çµ
  - æ”¹ç‚º http://192.168.0.32:8888/{id}/{id}.pdf
  - ä¸å†é¡¯ç¤º nhentai ç¶²å€
- [x] 2026-01-02 `/list` é¡¯ç¤ºè©³ç´°çµ±è¨ˆ
  - åˆ†åˆ¥é¡¯ç¤º Eagle/Downloads æ•¸é‡
- [x] 2026-01-02 `/random` æŒ‡ä»¤æ”¯æ´ä¾†æºé¸æ“‡
  - æ–°å¢ `source` åƒæ•¸ï¼šeagleã€downloadsã€all
  - ä½¿ç”¨ `secrets` æ¨¡çµ„æå‡éš¨æ©Ÿæ€§
- [x] 2026-01-02 `/list` æŒ‡ä»¤é¡¯ç¤ºå…¨éƒ¨æœ¬å­
  - åˆä½µ Eagle Library å’Œä¸‹è¼‰è³‡æ–™å¤¾
  - ğŸ¦…/ğŸ“ ä¾†æºæ¨™ç¤º
- [x] 2026-01-02 æ‰¹æ¬¡ä¸‹è¼‰å®Œæˆç¸½çµ
  - å¤šæª”ä¸‹è¼‰å®Œæˆå¾Œé¡¯ç¤ºçµ±è¨ˆ (æˆåŠŸ/å¤±æ•—)
- [x] 2026-01-02 æ¸…ç† on_message è™•ç†é‚è¼¯
  - ç§»é™¤èˆŠçš„ `known_commands` è½‰æ›é‚è¼¯
  - ç§»é™¤ `!dl` å’Œ `!test` å‚³çµ±æŒ‡ä»¤è™•ç†
  - å°ˆç”¨é »é“ï¼šå¿½ç•¥ `/` é–‹é ­è¨Šæ¯ï¼ˆç”± Discord è™•ç†ï¼‰
  - éå°ˆç”¨é »é“ï¼šæç¤ºä½¿ç”¨æ–œç·šæŒ‡ä»¤
- [x] 2026-01-02 å‡ç´šç‚ºæ–œç·šæŒ‡ä»¤ç‰ˆæœ¬ (v3.0.0)
  - æ‰€æœ‰æŒ‡ä»¤æ”¹ç‚º Discord æ–œç·šæŒ‡ä»¤ (/dl, /search, /read ç­‰)
  - å°ˆç”¨é »é“ä»æ”¯æ´ç›´æ¥è²¼è™Ÿç¢¼ä¸‹è¼‰ + test æ¨¡å¼
- [x] 2026-01-02 ä¿®å¾© Docker å®¹å™¨ Eagle Library è·¯å¾‘
  - `eagle_library.py` è‡ªå‹•åµæ¸¬ Docker ç’°å¢ƒ
  - Docker ä½¿ç”¨ `/app/eagle-library` å’Œ `/app/imports-index.json`
- [x] 2026-01-02 æ–°å¢é‡è¤‡ä¸‹è¼‰æª¢æŸ¥åŠŸèƒ½
  - `/dl` æŒ‡ä»¤åŠ å…¥ `force` åƒæ•¸å¼·åˆ¶é‡æ–°ä¸‹è¼‰

## Next Steps (ä¸‹ä¸€æ­¥)
- [ ] é‡æ–°éƒ¨ç½² Docker ä¸¦æ¸¬è©¦æ–°åŠŸèƒ½
- [ ] æ¸¬è©¦ `/random` ä¾†æºåƒæ•¸
- [ ] æ¸¬è©¦æ‰¹æ¬¡ä¸‹è¼‰ç¸½çµåŠŸèƒ½

## Notes (å‚™è¨»)
- å°ˆæ¡ˆç‰ˆæœ¬ï¼šv3.1.0
- ä¸»è¦ç¨‹å¼ï¼šrun.py
